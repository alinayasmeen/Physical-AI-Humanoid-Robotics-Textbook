# مینی پروجیکٹ 2: وژول سروو روبوٹ

**موڈیول**: 3 - پرچیپشن اور سینسر
**مدت**: 3-4 گھنٹے
**پریشانی**: اعلی

## جائزہ

ایک وژول سروو سسٹم نافذ کریں جو ایک روبوٹ کو ڈیٹیکٹ کی گئی اشیاء کو خود بخود فالو کرنے اور اس کے ساتھ بات چیت کرنے کے قابل بناتا ہے. روبوٹ کیمرہ فیڈ بیک کا استعمال کرتے ہوئے اپنی حرکت کو ریل ٹائم میں ایڈجسٹ کرتا ہے، بند حلقہ پرچیپشن-ایکشن کنٹرول کو ظاہر کرتا ہے.

## اہداف

اس مینی پروجیکٹ کو مکمل کرنے کے بعد، آپ:

1. امیج بیسڈ وژول سروو (IBVS) نافذ کریں گے
2. مناسب گینز کے ساتھ ایک کنٹرول سسٹم ڈیزائن کریں گے
3. ایج کیسز کو ہینڈل کریں گے (کھویا ہوا ٹارگٹ، متعدد ٹارگٹس، رکاوٹیں)
4. حقیقی دنیا کی ڈیپلائمنٹ کے لیے سیفٹی فیچرز انضمام کریں گے

## ضروریات

- موڈیول 3 کی لیبز 1-5 مکمل
- PID کنٹرول تصورات کی سمجھ
- ROS 2 ٹویسٹ میسجز سے واقفیت

## سسٹم معماری

```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│   کیمرہ     │────▶│  ڈیٹیکٹر   │────▶│  کنٹرولر   │
└─────────────┘     └─────────────┘     └─────────────┘
                                               │
                    ┌─────────────┐            │
                    │  سیفٹی      │◀───────────┤
                    │  مانیٹر    │            │
                    └─────────────┘            │
                           │                   │
                           ▼                   ▼
                    ┌─────────────┐     ┌─────────────┐
                    │  اوور رائیڈ │────▶│  روبوٹ      │
                    └─────────────┘     └─────────────┘
```

## ضروریات

### فنکشنل ضروریات

1. **ٹارگٹ ڈیٹیکشن**

   - رنگ یا شکل کا استعمال کرتے ہوئے ٹارگٹ آبجیکٹ ڈیٹیکٹ کریں
   - فریموں کے درمیان ٹارگٹ ٹریک کریں
   - عارضی اوکلیوشنز کو ہینڈل کریں

2. **وژول سروو**

   - کیمرہ ویو میں ٹارگٹ کو مرکز میں لائیں (اینگولر کنٹرول)
   - مطلوبہ فاصلہ برقرار رکھیں (لینیئر کنٹرول)
   - بے تکان حرکت بے جھول

3. **بیhevیئر اسٹیٹس**

   - SEARCHING: ٹارگٹ تلاش کرنے کے لیے گھومیں
   - TRACKING: حرکت پذیر ٹارگٹ کو فالو کریں
   - APPROACHING: سٹیشنری ٹارگٹ کی طرف بڑھیں
   - HOLDING: مطلوبہ فاصلے پر پوزیشن برقرار رکھیں
   - LOST: ٹارگٹ کھو گیا، تلاش پر واپس جائیں

4. **سیفٹی فیچرز**

   - زیادہ سے زیادہ رفتار کی حدود
   - رکاوٹ ڈیٹیکشن پر ہنگامی بندش
   - سینسر ناکامیوں کے لیے ویچ ڈاگ ٹائمر
   - باوقار ڈیگریڈیشن

### غیر فنکشنل ضروریات

- کم از کم 10 Hz پر کنٹرول لوپ
- 200ms سے کم ریسپانس ٹائم
- 10cm درستی کے اندر مستحکم فالو کرنا

## شروع کریں

### 1. پروجیکٹ کی ساخت

```
mini-project-02-visual-servoing/
├── starter/
│   ├── visual_servo_node.py    # مرکزی کنٹرول نوڈ
│   ├── target_detector.py      # ٹارگٹ ڈیٹیکشن
│   ├── servo_controller.py     # کنٹرول الگورتھم
│   └── safety_monitor.py       # سیفٹی سسٹم
└── solution/
    └── ...
```

### 2. کنٹرول الگورتھم

وژول سروو کنٹرولر پروپورشل کنٹرول استعمال کرتا ہے:

```python
# اینگولر ویلوسٹی (ٹارگٹ کی طرف گھومیں)
error_x = target_x - image_center_x
omega_z = -K_angular * error_x

# لینیئر ویلوسٹی (فاصلہ برقرار رکھیں)
error_area = desired_area - target_area
v_x = K_linear * error_area
```

### 3. اسٹیٹ مشین

مندرجہ ذیل اسٹیٹ ٹرانزیشنز نافذ کریں:

```
SEARCHING ──[ٹارگٹ ملا]──▶ TRACKING
TRACKING ──[ٹارگٹ قریب]──▶ APPROACHING
TRACKING ──[ٹارگٹ کھو گیا]──▶ LOST
APPROACHING ──[فاصلے پر]──▶ HOLDING
HOLDING ──[ٹارگٹ چلا گیا]──▶ TRACKING
LOST ──[ٹائم آؤٹ]──▶ SEARCHING
```

## نفاذ کے کام

### کام 1: ٹارگٹ ڈیٹیکشن (45 منٹ)

`target_detector.py` مکمل کریں:

- رنگ بیسڈ ڈیٹیکشن نافذ کریں
- یقین کی فلٹرنگ شامل کریں
- باؤنڈنگ باکس اور سینٹروڈ لوٹائیں

### کام 2: سروو کنٹرولر (60 منٹ)

`servo_controller.py` مکمل کریں:

- پروپورشل کنٹرول نافذ کریں
- رفتار کو ہموار کریں
- ایج کیسز کو ہینڈل کریں

### کام 3: اسٹیٹ مشین (45 منٹ)

`visual_servo_node.py` مکمل کریں:

- اسٹیٹ ٹرانزیشنز نافذ کریں
- ٹائم آؤٹ ہینڈلنگ شامل کریں
- اسٹیٹ تبدیلیاں لاگ کریں

### کام 4: سیفٹی مانیٹر (30 منٹ)

`safety_monitor.py` مکمل کریں:

- رفتار کی حد
- رکاوٹ ڈیٹیکشن انٹیگریشن
- ہنگامی بندش

### کام 5: انضمام ٹیسٹنگ (60 منٹ)

- سیمولیشن میں ٹیسٹ کریں
- کنٹرول گینز ٹیون کریں
- سیفٹی فیچرز کی تصدیق کریں

## جائزہ کے معیار

توثیق اسکرپٹ چلائیں:

```bash
python3 validate.py
```

متوقع چیکس:

- [ ] روبوٹ 50 پکسلز کے اندر ٹارگٹ کو مرکز میں لاتا ہے
- [ ] ہموار رفتار کے کمانڈز (جھول نہیں)
- [ ] اسٹیٹ ٹرانزیشنز درست کام کرتے ہیں
- [ ] سیفٹی حدود نافذ کی گئیں
- [ ] ٹارگٹ کے نقصان کو باوقار طریقے سے ہینڈل کرتا ہے
- [ ] کنٹرول لوپ 10+ Hz پر چلتا ہے

## ڈلیوریبلز

1. **کام کرتا ہوا سسٹم**: مکمل نفاذ
2. **ڈیمو ویڈیو**: 60 سیکنڈ کی ریکارڈنگ جو دکھاتی ہے:

   - ٹارگٹ حصول
   - فالو کرنے کا رویہ
   - نقصان اور بازیابی

3. **ٹیوننگ رپورٹ**: گین ویلیوز اور ٹیوننگ عمل دستاویز کریں
4. **سیفٹی تجزیہ**: نافذ کردہ سیفٹی فیچرز کی وضاحت کریں

## توسیع چیلنجز

1. **PID کنٹرول**: P کو مکمل PID کنٹرولر کے ساتھ تبدیل کریں
2. **پاتھ منصوبہ بندی**: ٹارگٹ تک پہنچنے کے لیے رکاوٹوں کے گرد پاتھ منصوبہ بند کریں
3. **متعدد ٹارگٹس**: ترجیح دیں اور ٹارگٹس کے درمیان سوئچ کریں
4. **گیسچر ریکوگنیشن**: ہاتھ کے اشاروں کا جواب دیں
5. **فارمیشن کنٹرول**: ایک لیڈر کو فالو کرنے والے متعدد روبوٹس

## ٹیوننگ گائیڈ

### اینگولر کنٹرول (K_angular)

- بہت کم: سست ریسپانس، ٹارگٹ ڈرائیف ہوتا ہے
- بہت زیادہ: جھول، اوور شوٹ
- شروع: 0.002، 0.001 سے ایڈجسٹ کریں

### لینیئر کنٹرول (K_linear)

- بہت کم: سست اپروچ، انڈر شوٹ
- بہت زیادہ: مسلسل حرکت، اوور شوٹ
- شروع: 0.0001، 0.00005 سے ایڈجسٹ کریں

### رفتار کو ہموار کرنا

- ایکسپونینشل موونگ ایوریج استعمال کریں
- ہموار موشن کے لیے الفا = 0.3
- جواب دہ موشن کے لیے الفا = 0.7

## وسائل

- [وژول سروو ٹیوٹوریل](https://visp-doc.inria.fr/doxygen/visp-daily/tutorial-ibvs.html)
- [ROS 2 کنٹرول تصورات](https://docs.ros.org/en/humble/Concepts/About-ROS-2-Control.html)
- [PID ٹیوننگ گائیڈ](https://pidtuner.com/)